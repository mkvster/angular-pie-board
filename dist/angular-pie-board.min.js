/*!
 * angular-pie-board
 * http://github.com/mkvster/angular-pie-board
 * Version: 0.0.0 - 2016-10-05T04:27:25.116Z
 * License: MIT
 */
!function(){"use strict";angular.module("pie.board",[]);var e=["$scope",function(e){e.$ctrl=e;var t=e.$ctrl;t.pieBoardData=null,t.startAngles=[],t.usedAngle=0,t.lastSelectedStart=-1,t.lastSelectedEnd=-1,t.internalPaddingX=1,t.internalPaddingY=1,t.init=function(){t.startAngle=parseInt(t.startAngle,10),t.pieBoardData=t.ngModel,t.arrange()},t.getTotalHeight=function(){return 2*(t.radius+t.piePaddingY+t.internalPaddingY)},t.getTotalWidth=function(){return 2*(t.radius+t.piePaddingX+t.internalPaddingX)},t.getGetAngleDir=function(){if(null===t.clockwise)return 1;var e=t.clockwise?1:-1;return e},t.addAngle=function(e,n){return e+t.getGetAngleDir()*n},t.recalculateStartAngles=function(){t.startAngle=parseInt(t.startAngle,10),t.startAngles=[],angular.forEach(t.pieBoardData,function(e){t.startAngles.push(t.addAngle(t.startAngle,t.usedAngle)),t.usedAngle+=e.angle})},t.shouldShowBlankSector=function(){return t.usedAngle<360},t.getDirection=function(e){var t=e*(Math.PI/180);return{x:Math.cos(t),y:Math.sin(t)}},t.arrange=function(){t.recalculateStartAngles()},t.getSectorPath=function(e,n){var i=t.getDirection(e),a=t.getDirection(n),l=parseInt(t.radius,10),r=t.piePaddingX+t.internalPaddingX,c=t.piePaddingY+t.internalPaddingY,d=n-e<=180?0:1,g=t.clockwise?1:0,s="M"+(l+r)+","+(l+c)+" L"+(l*(1+i.x)+r)+","+(l*(1+i.y)+c)+" A"+l+","+l+",1,"+d+","+g+","+(l*(1+a.x)+r)+","+(l*(1+a.y)+c)+"Z";return s},t.getPieSlicePath=function(e){var n=t.startAngles[e],i=t.addAngle(n,t.pieBoardData[e].angle);return t.getSectorPath(n,i)},t.getBlankSectorPath=function(){t.startAngle=parseInt(t.startAngle,10);var e=t.addAngle(t.startAngle,t.usedAngle),n=t.addAngle(t.startAngle,360);return t.getSectorPath(e,n)},t.getPieSliceTextPos=function(e){var n=t.startAngles[e],i=t.addAngle(n,t.pieBoardData[e].angle/2),a=t.getDirection(i),l=parseInt(t.radius,10);return{x:l+(l+t.textOffset)*a.x,y:l+(l+t.textOffset)*a.y}},t.getPieSliceTextX=function(e){var n=t.getPieSliceTextPos(e),i=n.x+t.piePaddingX+t.internalPaddingX;return i},t.getPieSliceTextY=function(e){var n=t.getPieSliceTextPos(e),i=n.y+t.piePaddingY+t.internalPaddingY;return i},t.findSelectedIndex=function(n){for(var i=0;i<e.selected.length;i++)if(t.selected[i]===n)return i;return-1},t.isPieSliceSelected=function(e){return angular.isArray(t.selected)?t.findSelectedIndex(e)>-1:t.selected===e},t.setSelectedPieSlice=function(e,n){if(angular.isArray(t.selected))if(n)t.selected.push(e);else{var i=t.findSelectedIndex(e);t.selected.splice(i,1)}else t.selected=e},t.toggleSelectedPieSlice=function(e){t.setSelectedPieSlice(e,!t.isSelectedPieSlice(e))},t.forPieSliceRange=function(e,t,n,i){for(var a=t<n?t:n,l=t<n?n:t,r=a;r<=l;r++)i(r)},t.findRange=function(e,n,i){var a=[];return t.forPieSliceRange(e,n,i,function(e){a.push(e)}),a},t.onPieSliceClick=function(n,i){if(angular.isArray(t.selected)){if(i.ctrlKey||i.shiftKey||(t.selected=[],t.lastSelectedStart=null),n===-1)return;if(i.shiftKey&&t.lastSelectedStart!==-1){var a=t.findRange(i.ctrlKey,t.lastSelectedStart,n);i.altKey&&e.lastSelectedEnd!==-1&&t.forPieSliceRange(i.ctrlKey,t.lastSelectedStart,t.lastSelectedEnd,function(e){var n=t.findSelectedIndex(e);n>=0&&t.selected.splice(n,1)});for(var l=0;l<a.length;l++)t.isPieSliceSelected(a[l])||t.selected.push(a[l]);t.lastSelectedEnd=n}else{var r=t.findSelectedIndex(n);r<0?(t.selected.push(n),t.lastSelectedStart=n):i.ctrlKey&&(t.selected.splice(r,1),t.lastSelectedStart=-1)}}else t.selected=n,t.lastSelectedStart=n}}],t=function(t){return{restrict:"E",scope:{ngModel:"=",selected:"=",radius:"=",startAngle:"=",clockwise:"=",textOffset:"=",piePaddingX:"=",piePaddingY:"="},templateUrl:"templates/pie-board.tpl.html",replace:!0,require:"ngModel",controller:e,link:function(e,t,n){e.init()}}};t.$inject=["$document"];var n=angular.module("pie.board");n.directive("pieBoard",t)}(),angular.module("pie.board").run(["$templateCache",function(e){e.put("templates/pie-board.tpl.html",'<div><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" class="pie-board-svg" ng-attr-height="{{$ctrl.getTotalHeight()}}" ng-attr-width="{{$ctrl.getTotalWidth()}}"><defs><pattern id="smalldot" patternunits="userSpaceOnUse" width="5" height="5"><image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPSc1JyBoZWlnaHQ9JzUnPgo8cmVjdCB3aWR0aD0nNScgaGVpZ2h0PSc1JyBmaWxsPScjZmZmJy8+CjxyZWN0IHdpZHRoPScxJyBoZWlnaHQ9JzEnIGZpbGw9JyNjY2MnLz4KPC9zdmc+" x="0" y="0" width="5" height="5"></image></pattern><pattern id="diagonal-stripe-1" patternunits="userSpaceOnUse" width="10" height="10"><image xlink:href="data:image/svg+xml;base64,PHN2ZyB4bWxucz0naHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmcnIHdpZHRoPScxMCcgaGVpZ2h0PScxMCc+CiAgPHJlY3Qgd2lkdGg9JzEwJyBoZWlnaHQ9JzEwJyBmaWxsPSd3aGl0ZScvPgogIDxwYXRoIGQ9J00tMSwxIGwyLC0yCiAgICAgICAgICAgTTAsMTAgbDEwLC0xMAogICAgICAgICAgIE05LDExIGwyLC0yJyBzdHJva2U9J2JsYWNrJyBzdHJva2Utd2lkdGg9JzEnLz4KPC9zdmc+Cg==" x="0" y="0" width="10" height="10"></image></pattern></defs><path ng-repeat="pieSlice in $ctrl.pieBoardData" ng-attr-id="{{pieSlice.id}}" ng-attr-d="{{$ctrl.getPieSlicePath($index)}}" ng-attr-fill="{{$ctrl.isPieSliceSelected($index)? \'aqua\' : pieSlice.color}}" ng-click="$ctrl.onPieSliceClick($index, $event)" stroke="black"></path><text ng-repeat="pieSlice in $ctrl.pieBoardData" ng-attr-x="{{$ctrl.getPieSliceTextX($index)}}" ng-attr-y="{{$ctrl.getPieSliceTextY($index)}}" ng-attr-font-weight="{{$ctrl.isPieSliceSelected($index)? \'bolder\' : \'normal\'}}" ng-attr-font-size="{{$ctrl.isPieSliceSelected($index)? 12 : 9}}" ng-click="$ctrl.onPieSliceClick($index, $event)" text-anchor="middle" cursor="default" dominant-baseline="middle" font-family="Courier">{{pieSlice.id}}</text><path ng-show="$ctrl.shouldShowBlankSector()" ng-attr-d="{{$ctrl.getBlankSectorPath()}}" style="fill: url(#smalldot) white;" stroke="black"></path></svg></div>')}]);
//# sourceMappingURL=angular-pie-board.min.js.map
